#### TO DO
- [ ] 구구의 Tomcat 구현 미션 (현재 4/4단계)
	- [x] Http Request 리팩터링 ✅ 2025-09-13
	- [x] Http Response 리팩터링 ✅ 2025-09-14
	- [x] Controller 인터페이스 추가 ✅ 2025-09-14
	- [ ] Thread pool 구현
- [ ] Reflection API 학습 테스트 진행
- [ ] Servlet과 Servlet Container 퀘스트 진행
- [ ] @MVC 구현 미션 (현재 0/3단계)


- [ ] 레오와 로그 시스템 구현 (Grafana Loki / ELK)
![[Pasted image 20250914223254.png]]
- Prometheus, AWS Cloudwatch: 전형적인 시계열 메트릭 모니터링 (시간에 흐름에 따라 수집되는 데이터를 메트릭으로 표현해서 대시보드나 임계치 알림으로 모니터링 하는 것)
- 내 생각: 시계열 메트릭 모니터링은, 서버에 이상 신호가 있을 때 빠르게 탐지해서 알림하는 용도로 쓴다면, 로그 수집 / 검색 / 시각화 툴 (ELK, Grafana Loki)는 특정 시간대에 발생한 트래픽 지연, 에러 패턴, 사용자 흐름 등을 **로그 타임라인으로 추적**하는 니즈를 충족할 수 있을 듯. 
- 즉 처음 로그 시스템을 도입하게 된 계기가 부하테스트 모니터링이니, 시계열 메트릭 모니터링보다는 로그 수집 및 시각화 툴을 이용하는 게 합당함.

---

- Grafana Loki는 로그 저장 시 로그 전체 텍스트가 아니라 메타데이터만 인덱싱하여 빠른 로그 수집과 검색을 지원하며, 로그 기반의 이벤트 추적과 문제 해결에 강점을 가짐. 따라서 특정 시간대의 트래픽 지연이나 오류 패턴 등 로그를 기반으로 한 상세한 추적 분석에 사용됨.
- ELK 스택(Elasticsearch, Logstash, Kibana)은 로그뿐 아니라 로그 데이터에 대한 강력한 검색과 분석 기능을 제공하므로, 다양한 원인 분석이나 보안 모니터링, 복잡한 쿼리 기반 로그 탐색에 유리함.

결론적으로, 두 솔루션 모두 시계열 메트릭으로 단순 모니터링하는 것보다는, 다수의 로그를 이용해 문제의 원인을 구체적으로 파악하거나 특정 시간대의 이벤트, 트래픽 지연 이슈를 탐색할 때 주로 활용됨. 상태 이상 알림 모니터링은 Prometheus 같은 시계열 메트릭 도구가 주로 담당하는 영역임.

기능 자체는 ELK가 더 강력한 것으로 보임. 하지만 단점으로는 높은 복잡도와 관리 난이도가 있음.
현재는 Grafana Loki가 맞는 선택으로 보임.

---
### 레오에게..

로그 시스템 관련해서 조사 해봤는데, 그때 레오가 말했던 것처럼 지금 상황에선 ELK보다 Grafana Loki가 더 적합할 것 같다고 결론내림.
내가 생각했던 것들 공유할게 Context 동기화 겸

[생각의 흐름]
이미 AWS Cloudwatch로 로그 시스템을 어느정도 구축해놨는데, 새로운 로그 시스템 도입을 생각하게 된 계기는 무엇인가?
-> 대량 데이터 생성 후 성능 테스트 , 쿼리 최적화 후 개선 정도 확인 등 상황에 맞는 여러 수치화된 데이터를 확인하고 싶은 니즈가 생겼음.
현재 AWS Cloudwatch에서 로그 수집 및 메트릭 시각화도 하기 때문에 데이터를 확인할 수 있긴 하지만, 예시로 "최근 1시간동안 특정 api의 응답 속도 평균 값", "지난 24시간 동안 특정 API의 응답 시간 추이", "DB 쿼리 지연 시간이 1초 이상인 요청의 비율", "성능 최적화 적용 후 CPU/메모리 사용률 감소율" 같이 우리 니즈에 맞는 수치를 쉽게 분석하기 어려움.

왜 AWS Cloudwatch로는 분석하기 어려울까?
-> AWS Cloudwatch는 **시계열 메트릭 모니터링** 방식이라고 함. 시계열 메트릭 모니터링이란 말 그대로 시간에 따라 변화하는 성능 지표를 기록/분석하여 시스템의 상태를 지속적으로 감시하는 것임.
즉, CloudWatch는 시계열 메트릭 모니터링이 본질이라 "CPU 사용률 80% 초과"" 같은 이벤트 감시에는 적합함. 하지만 "조건부 로그 필터링 기반의 수치화 (예: DB 응답 시간 > 1초 인 요청의 비율)에는 불편함.
이렇게 AWS Cloudwatch 막 할때는 몰랐는데, 생각해보니까 항상 시간을 기준으로 메트릭을 만들고 임계치를 넘어가면 즉시 알람을 발생시키는 **시계열 메트릭 모니터링** 이었음.
또 다른 시계열 메트릭 모니터링 시스템으로는 Prometheus 가 있음. 그래서 Prometheus도 후보에서 제외 DataDog도 시계열 메트릭 모니터링이더라고.

결국 **부하/성능 테스트에서의 다양한 지표 수치 확인 및 시각화**를 하려면 시계열 메트릭 모니터링이 아닌 로그 기반 분석 시스템을 사용해야됨
이게 ELK, Grafana Loki 같은거더라고 둘 다 로그 수집하고, 저장하고, 메타태그 추가하고.. 검색하고 시각화하고 등등 기능 제공함. 그래서 "DB 쿼리 지연 시간이 1초 이상인 요청의 비율 수치" 같은 복잡한 니즈 충족 가능



** 그래서 ELK vs Grafana Loki?**
ELK 는 전체 로그를 저장하고, Elastic Search를 붙여서 검색도 엄청 강력함. 그만큼 풍부하고 복잡한 쿼리를 다룰 수 있음. (복잡한 상황에 대한 수치화를 해낼 수 있다는 뜻임. 나중에 확장하면 AI 머신러닝도 붙여서 분석하게 할 수 있다고 하더라) 근데 그만큼 관리/설정할 게 많고 어려움. 

Grafana Loki는 로그 전체를 저장하지 않고 메타데이터(라벨)만 인덱싱해서 중요 정보만 저장함. 설치/운영이 쉬움. Grafana 혹은 Prometheus와 통합이 잘 됨. LogQL이라는 SQL같은 언어로 로그를 분석하고 수치를 뽑아낼 수 있다고 함.

# **결론**
- CloudWatch는 "실시간 상태 모니터링"에는 충분했지만, 성능 테스트/최적화 상황에서 우리가 원하는 다양한 수치화에는 한계가 있었다.
- ELK는 이런 요구를 충족할 수 있으나, 우리 상황에서는 과투자(복잡성/운영 부담)일 수 있음.
- Grafana Loki는 필요한 수치화된 로그 분석 요구를 충족하면서도, 도입/운영이 간단하므로 현 시점에서 가장 적합한 선택임.